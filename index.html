<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MIS 221 Scavenger Hunt Portal</title>
  <style>
    :root {
      --ink: #0f172a;
      --crimson: #8c1c2d;
      --crimson-dark: #6a0f1d;
      --sand: #f6f2ea;
      --card: #ffffff;
      --shadow: 0 16px 40px rgba(15, 23, 42, 0.16);
      --radius: 16px;
      --slate: #4b5563;
      --mint: #0fbf93;
      --amber: #f4a261;
      --indigo: #4338ca;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: "Inter", "Segoe UI", system-ui, -apple-system, sans-serif;
    }

    body {
      min-height: 100vh;
      background: radial-gradient(circle at 15% 20%, #ffe8e6 0%, rgba(255,255,255,0) 25%),
                  radial-gradient(circle at 85% 10%, #dbeafe 0%, rgba(255,255,255,0) 30%),
                  linear-gradient(135deg, #f8fafc 0%, #f0f4ff 45%, #fce7f3 100%);
      color: var(--ink);
      padding: 28px 16px 60px;
    }

    .page {
      max-width: 1200px;
      margin: 0 auto;
      display: flex;
      flex-direction: column;
      gap: 18px;
    }

    header {
      background: linear-gradient(135deg, var(--crimson) 0%, var(--crimson-dark) 60%, #111827 100%);
      color: #fff;
      border-radius: var(--radius);
      padding: 22px;
      box-shadow: var(--shadow);
      position: relative;
      overflow: hidden;
      isolation: isolate;
    }

    header::after {
      content: "";
      position: absolute;
      inset: 0;
      background: radial-gradient(circle at 20% 20%, rgba(255,255,255,0.28), rgba(255,255,255,0)),
                  linear-gradient(120deg, rgba(255,255,255,0.12), rgba(255,255,255,0));
      pointer-events: none;
    }

    h1 {
      font-size: clamp(1.8rem, 3vw, 2.4rem);
      margin-top: 6px;
      letter-spacing: -0.01em;
    }

    .eyebrow {
      text-transform: uppercase;
      letter-spacing: 0.12em;
      font-weight: 800;
      font-size: 0.85rem;
      color: rgba(255,255,255,0.8);
    }

    .pill-row { display: flex; flex-wrap: wrap; gap: 10px; margin-top: 10px; }
    .pill { background: rgba(255,255,255,0.14); padding: 10px 12px; border-radius: 999px; font-weight: 700; }

    .card {
      background: var(--card);
      border-radius: var(--radius);
      padding: 18px;
      box-shadow: var(--shadow);
      border: 1px solid rgba(0,0,0,0.04);
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .split {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
      gap: 14px;
    }

    .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(260px, 1fr)); gap: 12px; }

    label { font-weight: 700; font-size: 0.95rem; color: var(--ink); }
    input, select, textarea {
      width: 100%;
      padding: 10px 12px;
      border-radius: 12px;
      border: 1px solid #e2e8f0;
      background: #fff;
      font-size: 0.95rem;
      transition: border 0.2s, box-shadow 0.2s;
    }

    input:focus, textarea:focus, select:focus {
      outline: none;
      border-color: var(--crimson);
      box-shadow: 0 0 0 3px rgba(140, 28, 45, 0.18);
    }

    button {
      border: none;
      border-radius: 12px;
      padding: 10px 14px;
      font-weight: 800;
      cursor: pointer;
      transition: transform 0.15s ease, box-shadow 0.2s ease, background 0.2s;
      display: inline-flex;
      gap: 8px;
      align-items: center;
    }
    button:hover { transform: translateY(-1px); }
    .primary { background: var(--crimson); color: #fff; box-shadow: 0 10px 20px rgba(140, 28, 45, 0.25); }
    .ghost { background: #eef2ff; color: #312e81; }
    .outline { background: #fff; border: 1px solid #e2e8f0; }
    .danger { background: #ffe8e6; color: #7f1d1d; }

    .badge { padding: 6px 10px; background: #ecfeff; color: #0f766e; border-radius: 10px; font-weight: 700; }
    .muted { color: var(--slate); line-height: 1.5; }

    .status-pill { padding: 6px 10px; border-radius: 10px; font-weight: 700; font-size: 0.85rem; width: fit-content; }
    .pending { background: #fff7ed; color: #9a3412; }
    .approved { background: #ecfdf3; color: #166534; }
    .denied { background: #fee2e2; color: #7f1d1d; }

    table { width: 100%; border-collapse: collapse; }
    th, td { padding: 10px 8px; text-align: left; border-bottom: 1px solid #e5e7eb; font-size: 0.95rem; }
    thead { background: #f8fafc; color: #475569; font-size: 0.9rem; }

    .progress-bar { height: 12px; border-radius: 999px; background: #e5e7eb; overflow: hidden; }
    .progress-bar span { display: block; height: 100%; background: linear-gradient(90deg, #0fbf93, #22c55e); }

    .list { display: grid; gap: 10px; }
    .list-item { background: #f8fafc; border: 1px solid #e2e8f0; padding: 12px; border-radius: 12px; display: flex; justify-content: space-between; gap: 10px; align-items: center; flex-wrap: wrap; }

    .role-toggle { display: inline-flex; gap: 8px; background: #f8fafc; padding: 6px; border-radius: 14px; }
    .role-toggle button { border-radius: 10px; padding: 8px 12px; }
    .role-toggle button[aria-pressed="true"] { background: #eef2ff; color: #312e81; box-shadow: 0 8px 18px rgba(49, 46, 129, 0.14); }

    .inline { display: flex; gap: 10px; align-items: center; flex-wrap: wrap; }

    .hidden { display: none !important; }

    .login-shell {
      max-width: 520px;
      margin: 0 auto;
    }

    .full-screen-center {
      min-height: 60vh;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .staff-card { display: grid; grid-template-columns: auto 1fr; gap: 10px; align-items: center; padding: 12px; border: 1px solid #e2e8f0; border-radius: 12px; }
    .avatar { width: 46px; height: 46px; border-radius: 50%; background: linear-gradient(135deg, #94a3b8, #cbd5e1); display: grid; place-items: center; font-weight: 800; color: #0f172a; }

    @media (max-width: 640px) {
      body { padding: 18px 12px 48px; }
      header, .card { padding: 16px; }
    }
  </style>
</head>
<body>
  <div class="page">
    <header>
      <div class="eyebrow">MIS 221 / 520</div>
      <h1>MIS Scavenger Hunt Submission & Tracking Portal</h1>
      <p style="color: rgba(255,255,255,0.88); max-width: 740px; margin-top: 6px;">Students and TAs share one workspace: students can submit and manage their team items, while TAs handle grading, assignments, and roster administration.</p>
      <div class="pill-row">
        <div class="pill">Built for desktop & mobile</div>
        <div class="pill">Student + TA personas</div>
        <div class="pill">Demo-friendly (no real auth)</div>
      </div>
    </header>

    <section id="loginSection" class="full-screen-center">
      <div class="card login-shell">
        <div class="inline" style="justify-content: space-between;">
          <div>
            <p class="eyebrow" style="color: var(--crimson);">Start here</p>
            <h2 style="margin-top:4px;">Login to open the portal</h2>
            <p class="muted">The screen starts at the login stage. Use your school email or jump straight into Student or TA demo modes.</p>
          </div>
          <div class="badge">Portal locked</div>
        </div>

        <label for="email">School email</label>
        <input id="email" type="email" placeholder="wildcat@arizona.edu" autocomplete="username">
        <label for="code">Team or course code</label>
        <input id="code" type="text" placeholder="MIS221-Scavenger" autocomplete="off">

        <div class="inline" style="justify-content: space-between; align-items: center;">
          <div class="inline">
            <button class="primary" id="loginBtn">Login</button>
            <span class="muted" style="font-size:0.9rem;">No authentication stored — demo only.</span>
          </div>
          <div class="inline" style="gap:6px;">
            <button class="ghost" data-demo="student">Student Demo</button>
            <button class="ghost" data-demo="ta">TA Demo</button>
          </div>
        </div>
      </div>
    </section>

    <section id="portal" class="hidden">
      <div class="card" style="flex-direction: row; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 10px;">
        <div>
          <p class="eyebrow" style="color: var(--slate);">Role navigation</p>
          <h2 id="activeRoleTitle">Student workspace</h2>
          <p class="muted">Switch between Student and TA partitions. Each view keeps its own data so demos feel real.</p>
        </div>
        <div class="role-toggle" role="group" aria-label="Toggle persona">
          <button id="studentTab" aria-pressed="true">Student view</button>
          <button id="taTab" aria-pressed="false">TA view</button>
        </div>
      </div>

      <section id="studentArea" class="split">
        <div class="card">
          <div class="inline" style="justify-content: space-between;">
            <div>
              <p class="eyebrow" style="color: var(--slate);">Team access</p>
              <h2>Create or join your team</h2>
            </div>
            <span class="badge" id="studentTeamBadge">No team yet</span>
          </div>
          <div class="grid">
            <div>
              <label for="teamName">Team name</label>
              <input id="teamName" type="text" placeholder="Desert Foxes">
            </div>
            <div>
              <label for="teamCode">Join code</label>
              <input id="teamCode" type="text" placeholder="DFX21">
            </div>
          </div>
          <div class="inline">
            <button class="primary" id="createTeam">Create team</button>
            <button class="outline" id="joinTeam">Join team</button>
            <button class="ghost" id="editTeam">Edit team profile</button>
          </div>
          <p class="muted">Students can create, join, or edit their teams at any time.</p>
        </div>

        <div class="card">
          <div class="inline" style="justify-content: space-between;">
            <div>
              <p class="eyebrow" style="color: var(--slate);">Leaderboard</p>
              <h2>Team progress</h2>
            </div>
            <div class="badge" id="studentRank"></div>
          </div>
          <div id="studentLeaderboard" class="list"></div>
        </div>
      </section>

      <section id="studentAssignments" class="split">
        <div class="card">
          <div class="inline" style="justify-content: space-between;">
            <div>
              <p class="eyebrow" style="color: var(--slate);">Assignments</p>
              <h2>To-do</h2>
            </div>
            <span class="badge" id="todoCount"></span>
          </div>
          <div id="todoList" class="list"></div>
        </div>

        <div class="card">
          <div class="inline" style="justify-content: space-between;">
            <div>
              <p class="eyebrow" style="color: var(--slate);">Completed</p>
              <h2>Done & graded</h2>
            </div>
            <span class="badge" id="doneCount"></span>
          </div>
          <div id="doneList" class="list"></div>
        </div>
      </section>

      <section id="studentSubmissions" class="split">
        <div class="card">
          <div class="inline" style="justify-content: space-between;">
            <div>
              <p class="eyebrow" style="color: var(--slate);">Submit evidence</p>
              <h2>Upload or describe your item</h2>
            </div>
            <span class="badge">Status: pending / accepted / denied</span>
          </div>
          <label for="submissionTitle">Assignment</label>
          <input id="submissionTitle" placeholder="Find Dr. Valdez outside McClelland">
          <label for="submissionNotes">Notes or link</label>
          <textarea id="submissionNotes" placeholder="Dropped the photo in OneDrive folder..."></textarea>
          <div class="inline">
            <button class="primary" id="submitWork">Submit</button>
            <button class="outline" id="clearForm">Clear</button>
          </div>
          <p class="muted">Submissions move into "Pending" until a TA approves or denies them. Students can edit or delete their own entries before grading.</p>
        </div>

        <div class="card">
          <p class="eyebrow" style="color: var(--slate);">Submission history</p>
          <h2>Pending & reviewed</h2>
          <div id="studentSubmissionList" class="list"></div>
        </div>
      </section>

      <section id="taArea" class="hidden split" style="margin-top: 10px;">
        <div class="card">
          <div class="inline" style="justify-content: space-between;">
            <div>
              <p class="eyebrow" style="color: var(--slate);">TA admin</p>
              <h2>Teams</h2>
            </div>
            <span class="badge" id="teamTotal"></span>
          </div>
          <div class="grid">
            <div>
              <label for="taTeamName">Team name</label>
              <input id="taTeamName" placeholder="Wildcat Crew">
            </div>
            <div>
              <label for="taTeamCode">Join code</label>
              <input id="taTeamCode" placeholder="WILD-22">
            </div>
          </div>
          <div class="inline">
            <button class="primary" id="addTeam">Add team</button>
          </div>
          <div class="list" id="taTeamList"></div>
        </div>

        <div class="card">
          <div class="inline" style="justify-content: space-between;">
            <div>
              <p class="eyebrow" style="color: var(--slate);">Assignments</p>
              <h2>Create & edit</h2>
            </div>
            <span class="badge" id="assignmentTotal"></span>
          </div>
          <label for="taAssignmentTitle">Title</label>
          <input id="taAssignmentTitle" placeholder="Take a selfie with McClelland Hall">
          <label for="taAssignmentPoints">Points</label>
          <input id="taAssignmentPoints" type="number" placeholder="25">
          <label for="taAssignmentDue">Due date</label>
          <input id="taAssignmentDue" type="date">
          <div class="inline">
            <button class="primary" id="addAssignment">Add assignment</button>
          </div>
          <div class="list" id="taAssignmentList"></div>
        </div>
      </section>

      <section id="taSecondary" class="hidden split" style="margin-top: 10px;">
        <div class="card">
          <div class="inline" style="justify-content: space-between;">
            <div>
              <p class="eyebrow" style="color: var(--slate);">Staff bios</p>
              <h2>People tied to assignments</h2>
            </div>
            <span class="badge" id="staffTotal"></span>
          </div>
          <div class="grid">
            <div>
              <label for="staffName">Name</label>
              <input id="staffName" placeholder="Dr. Valdez">
            </div>
            <div>
              <label for="staffRole">Role</label>
              <input id="staffRole" placeholder="Academic Advisor">
            </div>
            <div>
              <label for="staffLocation">Location / hint</label>
              <input id="staffLocation" placeholder="Office 203, McClelland">
            </div>
          </div>
          <div class="inline">
            <button class="primary" id="addStaff">Add staff bio</button>
          </div>
          <div class="list" id="staffList"></div>
        </div>

        <div class="card">
          <div class="inline" style="justify-content: space-between;">
            <div>
              <p class="eyebrow" style="color: var(--slate);">Grading queue</p>
              <h2>Submissions to review</h2>
            </div>
            <span class="badge" id="reviewTotal"></span>
          </div>
          <div id="reviewList" class="list"></div>
          <div class="card" style="background:#0f172a; color:#fff; border:1px solid #1f2937;">
            <p class="eyebrow" style="color:#cbd5f5;">TA to-do</p>
            <h3 id="taTodoSummary" style="margin-top:4px;">Pending submissions ready to grade</h3>
            <p class="muted" style="color:rgba(255,255,255,0.78);">Keep this list clear to maintain momentum. Approve or deny with one click; statuses sync to the student view.</p>
          </div>
        </div>
      </section>

      <section id="taLeaderboard" class="card hidden" style="margin-top: 12px;">
        <div class="inline" style="justify-content: space-between;">
          <div>
            <p class="eyebrow" style="color: var(--slate);">Progress insights</p>
            <h2>Leaderboard (TA view)</h2>
          </div>
          <span class="badge">Live mirror of student view</span>
        </div>
        <div id="taLeaderboardList" class="list"></div>
      </section>
    </section>
  </div>

  <script>
    const state = {
      role: 'student',
      student: {
        team: { name: '', code: '' },
        assignments: [
          { id: 1, title: 'Team intro selfie', points: 15, due: '2024-09-08', status: 'todo' },
          { id: 2, title: 'Photo with MIS staff mentor', points: 25, due: '2024-09-10', status: 'pending' },
          { id: 3, title: 'Campus landmark hunt', points: 30, due: '2024-09-12', status: 'done' },
          { id: 4, title: 'Local business shoutout', points: 20, due: '2024-09-15', status: 'todo' }
        ],
        submissions: [
          { id: 101, title: 'Photo with MIS staff mentor', note: 'Shared via OneDrive link.', status: 'pending' },
          { id: 102, title: 'Campus landmark hunt', note: 'Uploaded sunset shot at Old Main.', status: 'approved' }
        ]
      },
      leaderboard: [
        { team: 'Desert Foxes', percent: 68 },
        { team: 'Wildcat Crew', percent: 82 },
        { team: 'Bear Down Squad', percent: 54 },
        { team: 'Analytics Ninjas', percent: 73 }
      ],
      admin: {
        teams: [
          { id: 'T1', name: 'Wildcat Crew', code: 'WILD-22', score: 82 },
          { id: 'T2', name: 'Desert Foxes', code: 'DFX-21', score: 68 },
          { id: 'T3', name: 'Analytics Ninjas', code: 'NINJA-10', score: 73 }
        ],
        assignments: [
          { id: 'A1', title: 'Take a selfie with McClelland Hall', points: 25, due: '2024-09-08' },
          { id: 'A2', title: 'Staff mentor photo', points: 30, due: '2024-09-10' }
        ],
        staff: [
          { id: 'S1', name: 'Dr. Valdez', role: 'Academic Advisor', location: 'Office 203, McClelland' },
          { id: 'S2', name: 'Prof. Hsu', role: 'MIS Lecturer', location: 'Eller 102 patio' }
        ],
        reviews: [
          { id: 'R1', team: 'Desert Foxes', title: 'Staff mentor photo', status: 'pending' },
          { id: 'R2', team: 'Wildcat Crew', title: 'Campus landmark hunt', status: 'pending' },
          { id: 'R3', team: 'Analytics Ninjas', title: 'Business shoutout', status: 'pending' }
        ]
      }
    };

    const loginSection = document.getElementById('loginSection');
    const portal = document.getElementById('portal');
    const activeRoleTitle = document.getElementById('activeRoleTitle');
    const studentTab = document.getElementById('studentTab');
    const taTab = document.getElementById('taTab');

    function showPortal(role) {
      state.role = role;
      loginSection.classList.add('hidden');
      portal.classList.remove('hidden');
      render();
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    document.querySelectorAll('[data-demo]').forEach(btn => {
      btn.addEventListener('click', () => {
        showPortal(btn.dataset.demo);
      });
    });

    document.getElementById('loginBtn').addEventListener('click', () => showPortal('student'));
    studentTab.addEventListener('click', () => { state.role = 'student'; render(); });
    taTab.addEventListener('click', () => { state.role = 'ta'; render(); });

    function render() {
      const studentArea = document.getElementById('studentArea');
      const studentAssignments = document.getElementById('studentAssignments');
      const studentSubmissions = document.getElementById('studentSubmissions');
      const taArea = document.getElementById('taArea');
      const taSecondary = document.getElementById('taSecondary');
      const taLeaderboard = document.getElementById('taLeaderboard');

      if (state.role === 'student') {
        activeRoleTitle.textContent = 'Student workspace';
        studentTab.setAttribute('aria-pressed', 'true');
        taTab.setAttribute('aria-pressed', 'false');
        studentArea.classList.remove('hidden');
        studentAssignments.classList.remove('hidden');
        studentSubmissions.classList.remove('hidden');
        taArea.classList.add('hidden');
        taSecondary.classList.add('hidden');
        taLeaderboard.classList.add('hidden');
      } else {
        activeRoleTitle.textContent = 'TA administration';
        studentTab.setAttribute('aria-pressed', 'false');
        taTab.setAttribute('aria-pressed', 'true');
        studentArea.classList.add('hidden');
        studentAssignments.classList.add('hidden');
        studentSubmissions.classList.add('hidden');
        taArea.classList.remove('hidden');
        taSecondary.classList.remove('hidden');
        taLeaderboard.classList.remove('hidden');
      }

      renderStudent();
      renderLeaderboard();
      renderTA();
    }

    function renderStudent() {
      const teamBadge = document.getElementById('studentTeamBadge');
      teamBadge.textContent = state.student.team.name ? `${state.student.team.name} (${state.student.team.code})` : 'No team yet';

      const todoList = document.getElementById('todoList');
      const doneList = document.getElementById('doneList');
      const todoItems = state.student.assignments.filter(a => a.status === 'todo' || a.status === 'pending');
      const doneItems = state.student.assignments.filter(a => a.status === 'done');
      document.getElementById('todoCount').textContent = `${todoItems.length} to-do`; 
      document.getElementById('doneCount').textContent = `${doneItems.length} completed`;

      todoList.innerHTML = todoItems.map(a => `
        <div class="list-item">
          <div>
            <strong>${a.title}</strong><br>
            <span class="muted">Due ${a.due} · ${a.points} pts</span>
          </div>
          <div class="inline">
            <span class="status-pill ${a.status === 'pending' ? 'pending' : 'approved'}">${a.status === 'pending' ? 'Pending' : 'To-do'}</span>
            <button class="ghost" onclick="markDone(${a.id})">Mark done</button>
          </div>
        </div>`).join('');

      doneList.innerHTML = doneItems.map(a => `
        <div class="list-item">
          <div>
            <strong>${a.title}</strong><br>
            <span class="muted">${a.points} pts · graded</span>
          </div>
          <span class="status-pill approved">Completed</span>
        </div>`).join('');

      const submissionList = document.getElementById('studentSubmissionList');
      submissionList.innerHTML = state.student.submissions.map(s => `
        <div class="list-item">
          <div>
            <strong>${s.title}</strong><br>
            <span class="muted">${s.note}</span>
          </div>
          <div class="inline">
            <span class="status-pill ${s.status === 'pending' ? 'pending' : s.status === 'approved' ? 'approved' : 'denied'}">${s.status}</span>
            ${s.status === 'pending' ? `<button class="ghost" onclick="editSubmission(${s.id})">Edit</button><button class="danger" onclick="deleteSubmission(${s.id})">Delete</button>` : ''}
          </div>
        </div>`).join('');
    }

    function renderLeaderboard() {
      const container = document.getElementById('studentLeaderboard');
      const taContainer = document.getElementById('taLeaderboardList');
      const rank = state.leaderboard
        .map((t, i) => ({ ...t, rank: i + 1 }))
        .sort((a, b) => b.percent - a.percent);
      document.getElementById('studentRank').textContent = `Top ${rank.length}`;
      const markup = rank.map(team => `
        <div class="list-item" style="width:100%;">
          <div style="flex:1; min-width: 180px;">
            <strong>#${team.rank} · ${team.team}</strong>
            <div class="progress-bar" aria-label="${team.team} progress"><span style="width:${team.percent}%"></span></div>
            <span class="muted">${team.percent}% complete</span>
          </div>
          <button class="ghost" aria-label="View ${team.team} details">Details</button>
        </div>`).join('');
      container.innerHTML = markup;
      taContainer.innerHTML = markup;
    }

    function renderTA() {
      const teamList = document.getElementById('taTeamList');
      teamList.innerHTML = state.admin.teams.map(team => `
        <div class="list-item">
          <div>
            <strong>${team.name}</strong><br>
            <span class="muted">Join code: ${team.code} · Score: ${team.score}%</span>
          </div>
          <div class="inline">
            <button class="ghost" onclick="editTeamAdmin('${team.id}')">Edit</button>
            <button class="danger" onclick="deleteTeam('${team.id}')">Delete</button>
          </div>
        </div>`).join('');
      document.getElementById('teamTotal').textContent = `${state.admin.teams.length} teams`;

      const assignmentList = document.getElementById('taAssignmentList');
      assignmentList.innerHTML = state.admin.assignments.map(a => `
        <div class="list-item">
          <div>
            <strong>${a.title}</strong><br>
            <span class="muted">${a.points} pts · Due ${a.due}</span>
          </div>
          <div class="inline">
            <button class="ghost" onclick="editAssignment('${a.id}')">Edit</button>
            <button class="danger" onclick="deleteAssignment('${a.id}')">Delete</button>
          </div>
        </div>`).join('');
      document.getElementById('assignmentTotal').textContent = `${state.admin.assignments.length} assignments`;

      const staffList = document.getElementById('staffList');
      staffList.innerHTML = state.admin.staff.map(s => `
        <div class="staff-card">
          <div class="avatar">${s.name.charAt(0)}</div>
          <div>
            <strong>${s.name}</strong><br>
            <span class="muted">${s.role} · ${s.location}</span>
          </div>
          <div class="inline" style="grid-column: 1 / -1; justify-content: flex-end;">
            <button class="ghost" onclick="editStaff('${s.id}')">Edit</button>
            <button class="danger" onclick="deleteStaff('${s.id}')">Delete</button>
          </div>
        </div>`).join('');
      document.getElementById('staffTotal').textContent = `${state.admin.staff.length} staff profiles`;

      const reviewList = document.getElementById('reviewList');
      reviewList.innerHTML = state.admin.reviews.map(r => `
        <div class="list-item">
          <div>
            <strong>${r.title}</strong><br>
            <span class="muted">Team: ${r.team}</span>
          </div>
          <div class="inline">
            <button class="primary" onclick="setReviewStatus('${r.id}','approved')">Approve</button>
            <button class="danger" onclick="setReviewStatus('${r.id}','denied')">Deny</button>
          </div>
        </div>`).join('');
      document.getElementById('reviewTotal').textContent = `${state.admin.reviews.filter(r => r.status === 'pending').length} pending`;
      document.getElementById('taTodoSummary').textContent = `${state.admin.reviews.filter(r => r.status === 'pending').length} items ready to grade`;
    }

    function markDone(id) {
      const item = state.student.assignments.find(a => a.id === id);
      if (item) item.status = 'done';
      render();
    }

    document.getElementById('createTeam').addEventListener('click', () => {
      const name = document.getElementById('teamName').value.trim();
      const code = document.getElementById('teamCode').value.trim();
      if (!name || !code) return alert('Enter a team name and join code.');
      state.student.team = { name, code };
      alert('Team created! Share the code with classmates.');
      render();
    });

    document.getElementById('joinTeam').addEventListener('click', () => {
      const code = document.getElementById('teamCode').value.trim();
      if (!code) return alert('Enter a join code.');
      const found = state.admin.teams.find(t => t.code.toLowerCase() === code.toLowerCase());
      if (found) {
        state.student.team = { name: found.name, code: found.code };
        alert(`Joined ${found.name}!`);
      } else {
        alert('Team not found. Try a different code or create one.');
      }
      render();
    });

    document.getElementById('editTeam').addEventListener('click', () => {
      if (!state.student.team.name) return alert('Join or create a team first.');
      const newName = prompt('Update team name', state.student.team.name);
      if (newName) state.student.team.name = newName;
      render();
    });

    document.getElementById('submitWork').addEventListener('click', () => {
      const title = document.getElementById('submissionTitle').value.trim();
      const note = document.getElementById('submissionNotes').value.trim();
      if (!title) return alert('Add an assignment title.');
      const entry = { id: Date.now(), title, note: note || 'No notes provided.', status: 'pending' };
      state.student.submissions.unshift(entry);
      state.student.assignments.push({ id: Date.now(), title, points: 10, due: 'TBD', status: 'pending' });
      document.getElementById('submissionTitle').value = '';
      document.getElementById('submissionNotes').value = '';
      render();
    });

    document.getElementById('clearForm').addEventListener('click', () => {
      document.getElementById('submissionTitle').value = '';
      document.getElementById('submissionNotes').value = '';
    });

    function editSubmission(id) {
      const submission = state.student.submissions.find(s => s.id === id);
      if (!submission) return;
      const newTitle = prompt('Edit submission title', submission.title);
      const newNote = prompt('Edit notes', submission.note);
      if (newTitle) submission.title = newTitle;
      if (newNote) submission.note = newNote;
      render();
    }

    function deleteSubmission(id) {
      state.student.submissions = state.student.submissions.filter(s => s.id !== id);
      render();
    }

    document.getElementById('addTeam').addEventListener('click', () => {
      const name = document.getElementById('taTeamName').value.trim();
      const code = document.getElementById('taTeamCode').value.trim();
      if (!name || !code) return alert('Add both a team name and join code.');
      state.admin.teams.push({ id: `T${Date.now()}`, name, code, score: 0 });
      document.getElementById('taTeamName').value = '';
      document.getElementById('taTeamCode').value = '';
      render();
    });

    function editTeamAdmin(id) {
      const team = state.admin.teams.find(t => t.id === id);
      if (!team) return;
      const newName = prompt('Edit team name', team.name);
      const newCode = prompt('Edit join code', team.code);
      if (newName) team.name = newName;
      if (newCode) team.code = newCode;
      render();
    }

    function deleteTeam(id) {
      state.admin.teams = state.admin.teams.filter(t => t.id !== id);
      render();
    }

    document.getElementById('addAssignment').addEventListener('click', () => {
      const title = document.getElementById('taAssignmentTitle').value.trim();
      const points = Number(document.getElementById('taAssignmentPoints').value) || 0;
      const due = document.getElementById('taAssignmentDue').value || 'TBD';
      if (!title) return alert('Add an assignment title.');
      state.admin.assignments.push({ id: `A${Date.now()}`, title, points, due });
      document.getElementById('taAssignmentTitle').value = '';
      document.getElementById('taAssignmentPoints').value = '';
      document.getElementById('taAssignmentDue').value = '';
      render();
    });

    function editAssignment(id) {
      const a = state.admin.assignments.find(x => x.id === id);
      if (!a) return;
      const newTitle = prompt('Edit assignment title', a.title);
      if (newTitle) a.title = newTitle;
      render();
    }

    function deleteAssignment(id) {
      state.admin.assignments = state.admin.assignments.filter(a => a.id !== id);
      render();
    }

    document.getElementById('addStaff').addEventListener('click', () => {
      const name = document.getElementById('staffName').value.trim();
      const role = document.getElementById('staffRole').value.trim();
      const location = document.getElementById('staffLocation').value.trim();
      if (!name) return alert('Add a staff name.');
      state.admin.staff.push({ id: `S${Date.now()}`, name, role: role || 'Staff', location: location || 'TBD' });
      document.getElementById('staffName').value = '';
      document.getElementById('staffRole').value = '';
      document.getElementById('staffLocation').value = '';
      render();
    });

    function editStaff(id) {
      const s = state.admin.staff.find(x => x.id === id);
      if (!s) return;
      const newName = prompt('Edit name', s.name);
      const newRole = prompt('Edit role', s.role);
      const newLoc = prompt('Edit location', s.location);
      if (newName) s.name = newName;
      if (newRole) s.role = newRole;
      if (newLoc) s.location = newLoc;
      render();
    }

    function deleteStaff(id) {
      state.admin.staff = state.admin.staff.filter(s => s.id !== id);
      render();
    }

    function setReviewStatus(id, status) {
      const review = state.admin.reviews.find(r => r.id === id);
      if (!review) return;
      review.status = status;
      // Mirror status change in student submissions when titles align
      const submission = state.student.submissions.find(s => s.title === review.title);
      if (submission) submission.status = status;
      render();
    }

    render();
  </script>
</body>
</html>
